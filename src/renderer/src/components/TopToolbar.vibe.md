# TopToolbar 组件文档

## 用户需求
### 原始需求
> 用户需要在应用顶部有一个工具栏，用于管理项目和分支，包括选择项目、添加新项目、选择上游分支和工作分支等功能。

### 期望效果
- 用户可以方便地切换不同的翻译项目
- 用户可以添加新的项目到系统中
- 用户可以管理上游分支和工作分支
- 用户可以刷新上游分支获取最新更新
- 界面显示当前项目和分支的状态信息
- 上游分支选择会被保存，下次打开应用时自动恢复
- 工作分支使用Git仓库的当前分支，不保存状态

## 实现功能
### 主要功能
- [x] 项目选择：下拉框显示所有可用项目，支持切换当前项目
- [x] 添加项目：按钮触发文件选择器，添加新的Git仓库项目
- [x] 上游分支管理：显示和选择上游分支，支持刷新上游更新
- [x] 工作分支管理：显示和切换本地工作分支
- [x] 状态显示：实时显示当前项目和分支信息
- [x] 加载状态：在操作过程中显示加载指示器
- [x] 错误处理：捕获和显示操作错误信息
- [x] 上游分支持久化：上游分支选择保存到项目配置中
- [x] 工作分支动态获取：工作分支从Git仓库实时获取
- [x] 自动项目选择：应用启动时自动选择第一个项目

## 技术实现
### 分支管理策略
1. **上游分支**：保存在项目配置中，应用重启后自动恢复
2. **工作分支**：从Git仓库实时获取，不保存状态
3. **分支切换**：项目切换时自动恢复上游分支，获取当前工作分支

### 数据流
1. **应用启动**：自动选择第一个项目，恢复上游分支设置
2. **项目切换**：保存当前上游分支，加载新项目的分支信息
3. **分支选择**：上游分支立即保存，工作分支实时切换

## 变更历史
### v1.0.0
- **变更类型**: 新增
- **变更原因**: 实现项目管理和分支管理功能
- **变更内容**: 
  - 创建TopToolbar组件
  - 实现项目选择、添加、切换功能
  - 实现分支管理和刷新功能
  - 添加加载状态和错误处理
  - 修复添加项目后分支数据不刷新的问题
  - 修复TypeScript类型错误

### v1.1.0
- **变更类型**: 优化
- **变更原因**: 改善用户界面体验
- **变更内容**: 
  - 为上游分支和工作分支下拉框添加固定宽度（w-48）
  - 使界面布局更加整齐美观

### v2.0.0
- **变更类型**: 重构
- **变更原因**: 实现分支状态的持久化和动态获取
- **变更内容**:
  - 上游分支选择保存到项目配置中
  - 工作分支从Git仓库实时获取
  - 应用启动时自动选择第一个项目
  - 项目切换时自动恢复分支状态
  - 修复分支信息加载的时序问题 